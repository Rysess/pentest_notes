# Windows tools

## RPC

### rpcclient

1. Connect to a RPC service as an anonymous user

```bash
rpcclient -U "%" X.X.X.X
```

2. Connect to a RPC service as a user

```bash
rpcclient -U "<user>%<password>" X.X.X.X
```

3. Useful rpc commands

<details>
  <summary>Users enumeration</summary>

```bash
querydispinfo # List users
enumdomusers # List users
queryuser <0xrid> # User details
queryusergroups <0xrid> # User groups
lookupnames <username> # SID
queryuseraliases [builtin|domain] <sid> # Aliases
```

</details>

<details>
  <summary>Group enumeration</summary>

```bash
enumdomgroups # List groups
querygroup  <0xrid> # Group details
querygroupmem  <0xrid> # Group members
```

</details>

<details>
  <summary>Domains enumeration</summary>

```bash
enumdomains # List domains
lsaquery # Get SID
querydominfo # Domain info:
```

</details>
<details>
  <summary>Shares enumeration</summary>

```bash
netshareenumall # Enumerate all available shares
netsharegetinfo <share> # Info about a share
```

</details>

<details>
  <summary>More SIDs</summary>

```bash
lookupnames <username> # Find SIDs by name
lsaenumsid # Find more SIDs
lookupsids <sid> # RID cycling (check more SIDs)
```

</details>
